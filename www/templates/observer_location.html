{# observer input data table and java scripts #}

<div id="observer_location">

  <script type="text/javascript">

    $(function() {

      $( "#_date" ).datepicker({ dateFormat: $.datepicker.ISO_8601 });


      $("#set_location").click(function(e) {
        {# astronomy.js uses document.getElementById #}
        astronomy.setLocation("_latitude", "_longitude", "_timezone", e);
      });


      $("#set_time").click(function(e) {

        {# TODO pad time with leading 0s #}

        var now = new Date();

        var date_str = now.getFullYear() + "-" + (parseFloat(now.getMonth()) + 1) +
                       "-" + now.getDate();
        $("#_date").val(date_str);

        var time_str = now.getHours() + ":" + now.getMinutes() + ":" + now.getSeconds();
        $("#_time").val(time_str);

      });


      $("#_longitude").change(function() {
        var timezone = Math.floor((parseFloat($("#_longitude").val()) + 7.5) / 15.0);
        $("#_timezone").val(timezone);
      });


    });

  </script>

  <table>

    <tr>

      <td>
	<button type="button" id="set_location">set location</button>
      </td>

      <th>Latitude</th>

      <td>
	<input type="text" id="_latitude" name="latitude">
      </td>

      <td>deg:min:sec</td>

    </tr>

    <tr>

      <td>
      </td>

      <th>Longitude</th>

      <td>
	<input type="text" id="_longitude" name="longitude">
      </td>

      <td>deg:min:sec</td>

    </tr>

    <tr>
      <td></td>

      <th>Date</th>

      <td>
	<input type="text" id="_date" name="date"> {# id needed for date picker, name for form #}
      </td>
      <td>year-mm-dd</td>
    </tr>

    <tr>

      <td>
	<button type="button" id="set_time">set time</button>
      </td>

      <th>Local Time</th>
      <td><input type="text" id="_time" name="time" value="12:00"></td>
      <td>hr:min:sec</td>
    </tr>

    <tr>
      <td></td>

      <th>Time Zone</th>
      <td>
	<input type="text" id="_timezone" name="timezone" value="0">
      </td>
      <td>hr</td>

    </tr>

    <tr>
      <td></td>
      <th>Daylight Savings</th>
      <td>
	<input type="checkbox" id="_dst" name="dst">
      </td>
    </tr>


  </table>

</div>
