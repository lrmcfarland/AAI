{# observer input data table and java scripts #}

<script type="text/javascript" src="{{ url_for('static', filename='aai.js') }}"></script>

<style>

.observer_box {
    margin:   2px;
    border:   1px solid navy;
    padding: 10px;

}

table#observer_location {
    width: 90%;
    margin-left: 5%;
    margin-right: 5%;

}

.observer_input.obox {
	width: 140px;
	font-size: 20px;
}

.observer_buttons.obox {
    font-size: 20px;
    margin-left: 20px;
    margin-right: 20px;
}

.observer_buttons.timeshift {
    font-size: 40px;
    margin-left: 20px;
    margin-right: 20px;
}

</style>

<script type="text/javascript">

  $(function() {

    {# ----- set date ----- #}

    $( "#_date" ).datepicker({ dateFormat: $.datepicker.ISO_8601 });

    {# ----- set location ----- #}

    $("#set_location").click(function(e) {
      {# aai.js uses document.getElementById #}
      aai.setLocation("_latitude", "_longitude", "_timezone");
    });


    {# ----- set time ----- #}

    $("#set_time").click(function(e) {
      let now = aai.getCurrentDateTime()
      $("#_date").val(now.date_str);
      $("#_time").val(now.time_str);
    });

    {# ----- set timezone from longitude ----- #}

    $("#_longitude").change(function() {
      aai.setTimezoneFromLocation("_longitude", "_timezone");
    });


    $("#show_help").click(function(e) {

	var help_message = [
	    "Degrees, and optional minutes and seconds are accepted as a ",
	    "time format with : between each element, e.g. 37:47:30 instead ",
	    "of 37\u00b0 47\u2032 30\u2033 for San Francisco's latitude. ",
	    "The timezone, in hours, is estimated from the longitude, but ",
	    "should be adjusted as needed."].join("");

	alert(help_message);

    });



  }); {# end jquery init function #}

</script>

<div class="observer_box">


  <h2 align="center">Observer's Location</h2>

  <br>

  <div id="observer_location">

    <table>

      <tr>

	<td rowspan="2" >
	  <button class="observer_buttons obox" type="button" id="set_location"  >Current Location</button>
	</td>

	<th>Latitude</th>

	<td>
	  <input type="text" id="_latitude" name="latitude" class="observer_input obox">
	</td>

	<td>deg[:min[:sec]]</td>

      </tr>

      <tr>

	<th>Longitude</th>

	<td>
	  <input type="text" id="_longitude" name="longitude" class="observer_input obox">
	</td>

	<td>deg[:min[:sec]]</td>

      </tr>

      <tr>
	<td rowspan="2" >
	  <button  class="observer_buttons obox" type="button" id="set_time">Current Time</button>
	</td>

	<th>Date</th>

	<td>
	  <input type="text" id="_date" name="date" class="observer_input obox"> {# id needed for date picker, name for form #}
	</td>
	<td>year-mm-dd</td>
      </tr>

      <tr>


	<th>Local Time</th>
	<td><input type="text" id="_time" name="time" value="12:00" class="observer_input obox"></td>
	<td>hr[:min[:sec]]</td>
      </tr>

      <tr>

	<td></td>

	<th>Time Zone</th>
	<td>
	  <input type="text" id="_timezone" name="timezone" value="0" class="observer_input obox">
	</td>
	<td>hr[:mm]</td>

      </tr>

      <tr>

	<td>
	</td>

	<th>DST</th>

	<td>
	  <input type="checkbox" id="_dst" name="dst">
	</td>

	<td>
	  daylight saving time
	</td>

      </tr>

    </table>
  </div>

  <div id="time_controls">

    <hr>
    <h2 align="center">Time Controls</h2>

    <br>

    <table id="time_table" align="center">

      <tr>
	<td>
	  <button class="observer_buttons timeshift" id="get_prev_day" title="Previous Day">&laquo;</button>
	</td>

	<td>
	  <button class="observer_buttons timeshift" id="get_prev_hour" title="Previous Hour">&lt;</button>
	</td>

	<td>
	  <button class="observer_buttons timeshift" id="get_current_time" title="Update Plot">&#x21BB;</button>
	</td>

	<td>
	  <button class="observer_buttons timeshift" id="get_next_hour" title="Next Hour">&gt;</button>
	</td>

	<td>
	  <button class="observer_buttons timeshift" id="get_next_day" title="Next Day">&raquo;</button>
	</td>

      </tr>

    </table>

  </div>

</div>
